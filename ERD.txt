-- Create tables

SET XACT_ABORT ON

BEGIN TRANSACTION QUICKDBD

-- Create tables for department
CREATE TABLE [department] (
    [dept_no] VARCHAR  NOT NULL ,
    [dept_name] varchar  NOT NULL 
)

-- create table for employees
CREATE TABLE [employee] (
    [emp_no] varchar  NOT NULL ,
    [dept_no] VARCHAR  NOT NULL 
)

-- create table for manager
CREATE TABLE [manager] (
    [dept_no] VARCHAR  NOT NULL ,
    [emp_no] varchar  NOT NULL 
)

-- create table for employee information
CREATE TABLE [emp_info] (
    [emp_no] VARCHAR  NOT NULL ,
    [emp_title_id] varchar  NOT NULL ,
    [birth_date] Date  NOT NULL ,
    [first_name] varchar  NOT NULL ,
    [last_name] varchar  NOT NULL ,
    [sex] varchar  NOT NULL ,
    [hire_date] Date  NOT NULL 
)

-- create table for salary
CREATE TABLE [salaries] (
    [emp_no] varchar  NOT NULL ,
    [salary] int  NOT NULL 
)

-- create table for title
CREATE TABLE [titles] (
    [emp_title_id] VARCHAR  NOT NULL ,
    [title] varchar  NOT NULL 
)

ALTER TABLE [department] WITH CHECK ADD CONSTRAINT [FK_department_dept_no] FOREIGN KEY([dept_no])
REFERENCES [employee] ([dept_no])

ALTER TABLE [department] CHECK CONSTRAINT [FK_department_dept_no]

ALTER TABLE [employee] WITH CHECK ADD CONSTRAINT [FK_employee_emp_no_dept_no] FOREIGN KEY([emp_no], [dept_no])
REFERENCES [manager] ([emp_no], [dept_no])

ALTER TABLE [employee] CHECK CONSTRAINT [FK_employee_emp_no_dept_no]

ALTER TABLE [manager] WITH CHECK ADD CONSTRAINT [FK_manager_emp_no] FOREIGN KEY([emp_no])
REFERENCES [salaries] ([emp_no])

ALTER TABLE [manager] CHECK CONSTRAINT [FK_manager_emp_no]

ALTER TABLE [emp_info] WITH CHECK ADD CONSTRAINT [FK_emp_info_emp_title_id] FOREIGN KEY([emp_title_id])
REFERENCES [titles] ([emp_title_id])

ALTER TABLE [emp_info] CHECK CONSTRAINT [FK_emp_info_emp_title_id]

ALTER TABLE [salaries] WITH CHECK ADD CONSTRAINT [FK_salaries_emp_no] FOREIGN KEY([emp_no])
REFERENCES [emp_info] ([emp_no])

ALTER TABLE [salaries] CHECK CONSTRAINT [FK_salaries_emp_no]

COMMIT TRANSACTION QUICKDBD